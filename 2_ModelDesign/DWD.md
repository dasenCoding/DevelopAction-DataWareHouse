# DWD 层建模

该层进行事实表的建模。
## 1 事实表的设计原则/ 方法/
首先， 事实表的设计原则：
1. 尽可能包含所有业务过程相关的事实：分析哪些事实与业务过程有关是设计中的重点，在事实表中尽量包含所有与业务过程相关的事实。
2. 只选择与业务过程相关的事实：如在下单的业务中，不应该包括支付金额
3. 分解不可加性事实为可加组件
4. 在选择维度和事实之前必须先声明粒度：粒度决定了唯独模型的可扩展性，粒度越细，维度模型的可扩展性越强。建议从最低级别的原子粒度开始，因为原子粒度保证了最大限度地灵活性，可以支持无法预期地各种细节层次地用户需求
5. 在同一个事实表中不能有多种不同粒度地事实
6. 事实的单位 保持一致
7. 对事实的null值进行处理
8. 使用退化维度提高事实表的易用性


无论哪种事实表，都采用如下的设计方法：
1. 选择业务过程和确定事实表类型
2. 声明粒度：尽量选择最细级别的粒度
3. 确定维度
4. 确认事实：“过程的度量是什么？“选择与业务过程有关的所有事实
5. 冗余维度：将维度冗余到事实表中

## 2 构建事实表
接下来确认事实表，依旧是依据主题域下的业务过程来确认：

**代码提交和版本控制**： 
- Git提交
- 分支管理
- 合并代码

**Pull Requests管理**：
- 创建
- 审查
- 合并
- 关闭Pull Requests

**问题管理：**
- 创建
- 标记
- 关闭
- 评论Issues

**仓库和项目管理：**
- 创建和删除仓库
- 创建和删除项目
- 创建和删除分支

**用户管理：**
- 添加
- 删除
- 更新用户

**系统和日志管理：**
- 记录、备份、维护系统
- 记录、备份、维护日志


###2.1 开发者日志事件事实表

1. 事实表类型：事务型事实表
2. 声明粒度：一行记录代表了开发者在github中产生的一条行为记录
3. 确认维度：用户，组织，仓库
4. 确认事实：开发者在某时间在github上发生了某个行为

表名：**dwd_develop_event_info**: 包含事件相关的维度和度量，如事件类型、仓库、组织、用户等。

### 2.2 issue事实表

1. 事实表类型：周期快照事实表
2. 声明粒度：一行记录代表了Issue当前的内容信息
3. 确认维度：用户，issue，issue标签，issue指派人，issue评论
4. 确认事实：开发者在某时间在某仓库中提出了issue

表名：**dwd_issue_info**: 包含与问题和问题评论相关的维度和度量，如问题标题、内容、标签、评论数、关闭时间等。

### 2.3 pr事实表

1. 事实表类型：
2. 声明粒度：
3. 确认维度：
4. 确认事实：

表名：**dwd_pull_request_info**: 包含与拉取请求、审查评论相关的维度和度量，如拉取请求状态、合并状态、更改文件数、添加的行数、删除的行数等。

### 2.4 仓库事实表

1. 事实表类型：
2. 声明粒度：
3. 确认维度：
4. 确认事实：

表名：**dwd_repo_info**: 包含与存储库相关的维度和度量，如描述、大小、点赞数、分支数、语言、问题是否可用、项目是否可用、下载是否可用、wiki 是否可用、许可证、默认分支等。

### 2.5 发布事实表

1. 事实表类型：
2. 声明粒度：
3. 确认维度：
4. 确认事实：

表名：**dwd_release_info**: 包含与发布相关的维度和度量，如标签名称、提交的目标、发布名称、草稿状态、预发布状态、发布时间、正式发布时间、发布正文等。

### 2.6 组织成员事实表

1. 事实表类型：
2. 声明粒度：
3. 确认维度：
4. 确认事实：

表名：**dwd_org_member_info**: 包含与成员相关的维度和度量，如成员类型、创建时间等。

### 2.7 提交事实表

1. 事实表类型：
2. 声明粒度：
3. 确认维度：
4. 确认事实：

表名：**dwd_commit_comment_info**: 包含与提交评论相关的维度和度量，如评论作者、评论内容、评论位置等。

