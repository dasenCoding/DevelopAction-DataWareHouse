# DWD 层建模

该层进行事实表的建模。

## 1 事实表的设计原则/ 方法/
首先， 事实表的设计原则：
1. 尽可能包含所有业务过程相关的事实：分析哪些事实与业务过程有关是设计中的重点，在事实表中尽量包含所有与业务过程相关的事实。
2. 只选择与业务过程相关的事实：如在下单的业务中，不应该包括支付金额
3. 分解不可加性事实为可加组件
4. 在选择维度和事实之前必须先声明粒度：粒度决定了唯独模型的可扩展性，粒度越细，维度模型的可扩展性越强。建议从最低级别的原子粒度开始，因为原子粒度保证了最大限度地灵活性，可以支持无法预期地各种细节层次地用户需求
5. 在同一个事实表中不能有多种不同粒度地事实
6. 事实的单位 保持一致
7. 对事实的null值进行处理
8. 使用退化维度提高事实表的易用性

无论哪种事实表，都采用如下的设计方法：
1. 选择业务过程和确定事实表类型
2. 声明粒度：尽量选择最细级别的粒度
3. 确定维度
4. 确认事实：“过程的度量是什么？“选择与业务过程有关的所有事实
5. 冗余维度：将维度冗余到事实表中

## 2 构建事实表

接下来确认事实表，依旧是依据主题域下的业务过程来确认(加粗的为主题域, 下面的是业务流程)：

> 对业务流程总结，'-' 后面的是事实表。

**issue域**
- 开发者提出issue
- 协作者/ 开发者在issue下进行讨论

**pull request域**
- 开发者fock仓库
- 开发者创建资源/分支/
- 开发者push代码
- 开发者的pull request
- reviewer审查 pull request
- 拉去请求被合并
- 开发者删除分支/资源/

**仓库域**
- 管理员发布仓库版本
- 管理员上传版本附带资源


###2.1 开发者日志事件事实表

1. 事实表类型：事务型事实表
2. 声明粒度：一行记录代表了开发者在github中产生的一条行为记录
3. 确认维度：用户，组织，仓库
4. 确认事实：开发者在某时间在github上发生了某个行为

表名：**dwd_develop_event_info**: 包含事件相关的维度和度量，如事件类型、仓库、组织、用户等。

### 2.2 issue事实表

1. 事实表类型：
2. 声明粒度：一行记录代表了Issue当前的内容信息
3. 确认维度：用户，仓库
4. 确认事实：开发者在某时间在某仓库中提出了issue

表名：**dwd_issue_info**: 包含与issue相关的维度和度量，包含的内容：issue的信息,标签信息,协作者信息,更新信息。

### 2.3 issue讨论事实表
1. 事实表类型：
2. 声明粒度：一行记录代表了开发者在issue下的评论信息
3. 确认维度：用户，仓库
4. 确认事实：开发者在某时间在某仓库中对issue进行了回复

表名：**dwd_issue_comment_info**:包含与issue回复相关的维度和度量, 包含的信息: comment信息, comment作者, 评论时间。

### 2.4 fock仓库事实表

1. 事实表类型：
2. 声明粒度：开发者fock某个仓库
3. 确认维度：开发者，仓库
4. 确认事实：开发者在某时间点fock了某个仓库

表名：**dwd_fock_info**: 包含与开发者fock仓库相关的维度和度量，如fock信息, 仓库名称, 拥有者信息等。

### 2.5 开发者创建分支事实表

1. 事实表类型：
2. 声明粒度：开发者创建了某个分支
3. 确认维度：开发者
4. 确认事实：一行记录代表开发在某仓库下创建的分支

表名：**dwd_create_info**: 包含与创建相关的维度和度量，如资源类型, 事件, 描述等。

### 2.6 push事实表

1. 事实表类型：
2. 声明粒度：开发者在分支上进行推送
3. 确认维度：开发者，仓库
4. 确认事实：一行记录代表了开发者进行的一次推送

表名：**dwd_push_info**: 包含与推送相关的维度和度量，如提交次数, 分支, 作者信息等。

### 2.7 pull request事实表

1. 事实表类型：
2. 声明粒度：开发者提出的pr
3. 确认维度：开发者，仓库
4. 确认事实：一行记录代表了开发者提出的pr合并的汇总信息

表名：**dwd_pull_request_info**: 包含与拉去请求相关的维度和度量，如提交次数, 添加删除代码行数,合并标识, 合并该PR的开发者信息等。

### 2.8 审查pr事实表

1. 事实表类型：
2. 声明粒度：
3. 确认维度：开发者，仓库
4. 确认事实：一行记录代表了审查者对pr进行的一次审查意见

表名：**dwd_review_pr_info**: 包含与审查者审查pr相关的维度和度量，如审查的内容, 作者信息, 审查意见的更新信息等。

### 2.9 pr合并事实表

1. 事实表类型：
2. 声明粒度：审查者合并pr
3. 确认维度：开发者，仓库
4. 确认事实：一行记录代表了审查者合并该pr的信息。

表名：**dwd_merged_pr_info**: 包含与审查者合并pr相关的维度和度量，如合并该pr的作者信息, 日期等。


### 2.10 开发者删除分支事实表

1. 事实表类型：
2. 声明粒度：开发者删除分支资源
3. 确认维度：开发者，仓库
4. 确认事实：一行记录代表了删除相关分支的资源。

表名：**dwd_delete_info**: 包含与开发者删除的分支/资源相关的维度和度量，如分支信息等。


### 2.11 发布仓库版本事实表

1. 事实表类型：
2. 声明粒度：开发者发布一个仓库版本
3. 确认维度：开发者，仓库
4. 确认事实：一行记录代表了开发者发布的一个仓库版本。

表名：**dwd_release_info**: 包含与开发者发布仓库版本相关的维度和度量，如版本信息等。

### 2.12 上传版本附带资源事实表

1. 事实表类型：
2. 声明粒度：开发者上传一个版本资源
3. 确认维度：开发者，仓库
4. 确认事实：一行记录代表了开发者上传的版本资源。

表名：**dwd_release_assets_info**: 包含与开发者上传仓库版本资源相关的维度和度量，如资源信息等。
